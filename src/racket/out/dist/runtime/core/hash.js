"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function make(e,r,t){var i=e.reduce(function(e,r){var t=(0,_slicedToArray3.default)(r,2),i=t[0],a=t[1];return e.set(i,a)},$.hamt.make(hashConfigs[r]));return new Hash(i,r,t)}function makeEq(e,r){return make(e,"eq",r)}function makeEqv(e,r){return make(e,"eqv",r)}function makeEqual(e,r){return make(e,"equal",r)}function makeFromAssocs(e,r,t){var i=[];return Pair.listForEach(e,function(e){i.push([e.hd,e.tl])}),make(i,r,t)}function map(e,r){var t=Pair.Empty;return e._h.forEach(function(e,i){t=Pair.make(r(i,e),t)}),t}function check(e){return e instanceof Hash}Object.defineProperty(exports,"__esModule",{value:!0});var _getIterator2=require("babel-runtime/core-js/get-iterator"),_getIterator3=_interopRequireDefault(_getIterator2),_slicedToArray2=require("babel-runtime/helpers/slicedToArray"),_slicedToArray3=_interopRequireDefault(_slicedToArray2),_getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn"),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=require("babel-runtime/helpers/inherits"),_inherits3=_interopRequireDefault(_inherits2);exports.make=make,exports.makeEq=makeEq,exports.makeEqv=makeEqv,exports.makeEqual=makeEqual,exports.makeFromAssocs=makeFromAssocs,exports.map=map,exports.check=check;var _lib=require("./lib.js"),$=_interopRequireWildcard(_lib),_pair=require("./pair.js"),Pair=_interopRequireWildcard(_pair),_primitive=require("./primitive.js"),hashConfigs={eq:{hash:$.hashEq,keyEq:$.isEq},eqv:{hash:$.hashEqv,keyEq:$.isEqv},equal:{hash:$.hashEqual,keyEq:$.isEqual}},Hash=function(e){function r(e,t,i){(0,_classCallCheck3.default)(this,r);var a=(0,_possibleConstructorReturn3.default)(this,(r.__proto__||(0,_getPrototypeOf2.default)(r)).call(this));return a._h=e,a._mutable=i,a._type=t,a}return(0,_inherits3.default)(r,e),(0,_createClass3.default)(r,[{key:"toString",value:function(){var e="",r=0,t=!0,i=!1,a=void 0;try{for(var u,s=(0,_getIterator3.default)(this._h);!(t=(u=s.next()).done);t=!0){var n=u.value,o=(0,_slicedToArray3.default)(n,2),l=o[0],h=o[1];e+="(",e+=$.toString(l),e+=" . ",e+=$.toString(h),e+=")",++r!=this._h.size&&(e+=" ")}}catch(e){i=!0,a=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw a}}var _="";return"eq"!==this._type&&"eqv"!==this._type||(_=this._type),"#hash"+_+"("+e+")"}},{key:"toRawString",value:function(){return"'"+this.toString()}},{key:"mutable",value:function(){return this._mutable}},{key:"ref",value:function(e,r){var t=this._h.get(e);if(void 0!==t)return t;if(void 0!==r)return r;throw $.racketCoreError("hash-ref","key not found")}},{key:"set",value:function(e,t){var i=this._h.set(e,t);if(!this._mutable)return new r(i,this._type,!1);this._h=i}},{key:"size",value:function(){return this._h.size}},{key:"equals",value:function(e){if(!check(e))return!1;if(this._h.size!==e._h.size||this._type!==e._type||this._mutable!==e._mutable)return!1;var r=!0,t=!1,i=void 0;try{for(var a,u=(0,_getIterator3.default)(this._h);!(r=(a=u.next()).done);r=!0){var s=a.value,n=(0,_slicedToArray3.default)(s,2),o=n[0],l=n[1],h=e._h.get(o);if(void 0===h||!$.isEqual(l,h))return!1}}catch(e){t=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(t)throw i}}return!0}},{key:"type",value:function(){return this._type}}]),r}(_primitive.Primitive);