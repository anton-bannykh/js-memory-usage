"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function getCurrentParameterization(){return Marks.getFirstMark(Marks.getFrames(),ParameterizationKey,!1)}function makeParameter(e){return function r(t){var a=getCurrentParameterization().get(r,!1)||__top.get(r,!1);if(a||void 0===t||(a=Box.make(e),__top.set(r,a)),void 0===t)return a&&a.get()||e;a.set(t)}}function extendParameterization(e){for(var r=e,t=0;t<(arguments.length<=1?0:arguments.length-1);t+=2)r=r.set(arguments.length<=t+1?void 0:arguments[t+1],Box.make(arguments.length<=t+1+1?void 0:arguments[t+1+1]));return r}function copyParameterization(e){var r=_lib.hamt.make(),t=!0,a=!1,o=void 0;try{for(var i,n=(0,_getIterator3.default)(e);!(t=(i=n.next()).done);t=!0){var u=i.value,l=(0,_slicedToArray3.default)(u,2),m=l[0],s=l[1];r=r.set(m,Box.make(s.get()))}}catch(e){a=!0,o=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw o}}return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExceptionHandlerKey=exports.ParameterizationKey=void 0;var _map=require("babel-runtime/core-js/map"),_map2=_interopRequireDefault(_map),_getIterator2=require("babel-runtime/core-js/get-iterator"),_getIterator3=_interopRequireDefault(_getIterator2),_slicedToArray2=require("babel-runtime/helpers/slicedToArray"),_slicedToArray3=_interopRequireDefault(_slicedToArray2);exports.getCurrentParameterization=getCurrentParameterization,exports.makeParameter=makeParameter,exports.extendParameterization=extendParameterization,exports.copyParameterization=copyParameterization;var _core=require("./core.js"),Core=_interopRequireWildcard(_core),_lib=require("./core/lib.js"),Marks=Core.Marks,Box=Core.Box,ParameterizationKey=exports.ParameterizationKey={},ExceptionHandlerKey=exports.ExceptionHandlerKey={},__top=void 0;!1===getCurrentParameterization()&&(Marks.setMark(ParameterizationKey,_lib.hamt.make()),__top=new _map2.default,Marks.registerAsynCallbackWrapper({onCreate:function(e){var r={};r.top=new _map2.default;var t=!0,a=!1,o=void 0;try{for(var i,n=(0,_getIterator3.default)(__top);!(t=(i=n.next()).done);t=!0){var u=i.value,l=(0,_slicedToArray3.default)(u,2),m=l[0],s=l[1];r.top.set(m,Box.make(s.get()))}}catch(e){a=!0,o=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw o}}r.bottom=copyParameterization(Marks.getFirstMark(Marks.getFrames(),ParameterizationKey,!1)),e.paramz=r},onInvoke:function(e){__top=e.paramz.top,Marks.setMark(ParameterizationKey,e.paramz.bottom)}}));